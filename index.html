<html>
  <head>
    <title>Gotcha!</title>
    <link rel="shortcut icon" type="image/png" href="res/favicon.png"/>
    <script src="leaflet/leaflet.js"></script>
    <link href="leaflet/leaflet.css" rel="stylesheet" />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      #mymap {
        width: 100%;
        height: 100%;
      }
    </style>
  </head>

  <body>
    <div id="mymap"></div>
  </body>

  <script>
    var LeafIcon = L.Icon.extend({
      options: {
        iconSize: [35, 55],
        shadowSize: [0, 0],
        iconAnchor: [17, 55],
        shadowAnchor: [0, 0],
        popupAnchor: [-3, -76],
      },
    });

    var baseIcon = new LeafIcon({
      iconUrl: "res/baseIcon.png",
    });

    var workerIcon = new LeafIcon({
      iconUrl: "res/workerIcon.png",
    });

    var mymap = L.map("mymap", {
      minZoom: 9,
      maxZoom: 15,
    });

    mymap.setView([42.39379, -72.528574], 14);

    L.TileLayer.Custom = L.TileLayer.extend({
      getTileUrl: function (coords) {
        url = "./tiles/" + coords.z + "/" + coords.x + "/" + coords.y + ".png";
        return url;
      },
    });

    L.tileLayer.Custom = function () {
      return new L.TileLayer.Custom();
    };
    L.tileLayer.Custom().addTo(mymap);

    // print markers
    var request = new XMLHttpRequest();
    request.open("GET", "data.json", false);
    request.send(null);
    var markerDB = JSON.parse(request.responseText);

    for (var i = 0; i < markerDB["workerNodes"].length; i++) {
        var newMarker = L.marker(markerDB["workerNodes"][i], { icon: workerIcon })
        newMarker.addTo(mymap);
        newMarker.bindPopup("<h3>Client Seeking Rescue</h3><span><strong>Lat</strong> " + markerDB["workerNodes"][i][0] + "<br><strong>Lon</strong> " + markerDB["workerNodes"][i][1]);
    }

    for (var i = 0; i < markerDB["baseNodes"].length; i++) {
        var newMarker = L.marker(markerDB["baseNodes"][i], { icon: baseIcon })
        newMarker.addTo(mymap);
        newMarker.bindPopup("<h3>First Responder Base Station</h3><span><strong>Lat</strong> " + markerDB["baseNodes"][i][0] + "<br><strong>Lon</strong> " + markerDB["baseNodes"][i][1]);
    }
  </script>
</html>
